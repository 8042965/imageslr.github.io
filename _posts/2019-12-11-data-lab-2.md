---
layout: post
title: 📈【深入理解计算机系统】位运算的奇技淫巧
date: 2019/12/11 20:00
---

这是自己总结的一些位运算的奇技淫巧。

## 1. 不用 for 循环，找到二进制最右侧的 1
`(x & (-x))`

`-x` 相当于 `~x+1`。`~x` 将所有位取反，则最右侧连续的 0 变成 1。再加 1，会使得 `~x` 最右侧的 0 进 1 变成 1，最右侧连续的 1 变成 0：
```
x:  1 1 0 0 0 ... 1 0 0 0
~x: 0 0 1 1 1 ... 0 1 1 1
-x: 0 0 1 1 1 ... 1 0 0 0
```

## 2. 将二进制表示的最右侧的 1 取反
`(x & (-x)) ^ x`。  
`(x & (-x))` 可以找到二进制表示的最右侧的 1 所在的位置。`-x == ^x + 1`。